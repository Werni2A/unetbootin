#!/bin/bash

mingwb="$(ls /usr/ | grep mingw32 | grep -v amd64 | head --lines 1)"
rvern="$(./vcs-revno)"
make clean
rm Makefile*
rm release/*
lupdate unetbootin.pro
lrelease unetbootin.pro
./qmake-windows "DEFINES += NIMBLEX" "RESOURCES += unetbootin-nimblex.qrc"
make
strip --strip-all release/unetbootin.exe
mv release/unetbootin.exe release/unetbootin-nimblex-windows-$rvern.exe
upc-ucl --lzma release/unetbootin-nimblex-windows-$rvern.exe
./qmake-linux "DEFINES += NIMBLEX" "RESOURCES += unetbootin-nimblex.qrc"
make
strip --strip-all unetbootin
mv unetbootin release/unetbootin-nimblex-linux-$rvern
upc-ucl --lzma release/unetbootin-nimblex-linux-$rvern
qmake -spec linux-g++-32 "RESOURCES += unetbootin-linux.qrc"

